{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://actions.platform/schemas/config/oauth-provider.schema.json",
  "title": "OAuth Provider Config",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "provider": { "type": "string" },
    "issuer": { "type": "string" },
    "discovery_document": { "type": "string", "description": "Optional .well-known discovery URL" },
    "authorization_endpoint": { "type": "string" },
    "token_endpoint": { "type": "string" },
    "revocation_endpoint": { "type": "string" },
    "introspection_endpoint": { "type": "string" },
    "device_authorization_endpoint": { "type": "string" },
    "jwks_uri": { "type": "string" },
    "grant_types_supported": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": [
          "authorization_code",
          "authorization_code_pkce",
          "refresh_token",
          "client_credentials",
          "device_code",
          "jwt_bearer",
          "saml_bearer_assertion"
        ]
      }
    },
    "token_endpoint_auth_methods_supported": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["client_secret_basic", "client_secret_post", "private_key_jwt", "none"]
      }
    },
    "code_challenge_methods_supported": {
      "type": "array",
      "items": { "type": "string", "enum": ["S256", "plain"] }
    },
    "default_scopes": { "type": "array", "items": { "type": "string" } },
    "template_params": { "type": "object", "additionalProperties": { "type": "string" } },
    "tenant_discovery": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "supports_instance_discovery": { "type": "boolean" },
        "sandbox_issuer": { "type": "string" }
      }
    },
    "notes": { "type": "string" }
  },
  "required": ["provider"]
}

